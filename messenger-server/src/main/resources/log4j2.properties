# Log4j2 Configuration File
# Using properties format for simplicity and readability
# Version: 2.23.1 (secure, no known vulnerabilities)

# Root logger configuration
# Available levels: TRACE, DEBUG, INFO, WARN, ERROR, FATAL, OFF
status = TRACE
name = MessengerServerConfig

# Define appenders
appenders = console, file, errorFile

# Console Appender - for development and debugging
appender.console.type = Console
appender.console.name = ConsoleAppender
appender.console.layout.type = PatternLayout
appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n
appender.console.filter.threshold.type = ThresholdFilter
appender.console.filter.threshold.level = TRACE

# File Appender - general application logs
appender.file.type = RollingFile
appender.file.name = FileAppender
appender.file.fileName = logs/messenger-server.log
appender.file.filePattern = logs/messenger-server-%d{yyyy-MM-dd}-%i.log.gz
appender.file.layout.type = PatternLayout
appender.file.layout.pattern = %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n
appender.file.policies.type = Policies
# Rotate daily
appender.file.policies.time.type = TimeBasedTriggeringPolicy
appender.file.policies.time.interval = 1
appender.file.policies.time.modulate = true
# Rotate when file reaches 10MB
appender.file.policies.size.type = SizeBasedTriggeringPolicy
appender.file.policies.size.size = 10MB
# Keep maximum 30 archived files
appender.file.strategy.type = DefaultRolloverStrategy
appender.file.strategy.max = 30
appender.file.filter.threshold.type = ThresholdFilter
appender.file.filter.threshold.level = DEBUG

# Error File Appender - only errors and fatal messages
appender.errorFile.type = RollingFile
appender.errorFile.name = ErrorFileAppender
appender.errorFile.fileName = logs/messenger-server-error.log
appender.errorFile.filePattern = logs/messenger-server-error-%d{yyyy-MM-dd}-%i.log.gz
appender.errorFile.layout.type = PatternLayout
appender.errorFile.layout.pattern = %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n%throwable
appender.errorFile.policies.type = Policies
appender.errorFile.policies.time.type = TimeBasedTriggeringPolicy
appender.errorFile.policies.time.interval = 1
appender.errorFile.policies.time.modulate = true
appender.errorFile.policies.size.type = SizeBasedTriggeringPolicy
appender.errorFile.policies.size.size = 10MB
appender.errorFile.strategy.type = DefaultRolloverStrategy
appender.errorFile.strategy.max = 30
appender.errorFile.filter.threshold.type = ThresholdFilter
appender.errorFile.filter.threshold.level = ERROR

# Root logger configuration
rootLogger.level = TRACE
rootLogger.appenderRefs = console, file, errorFile
rootLogger.appenderRef.console.ref = ConsoleAppender
rootLogger.appenderRef.file.ref = FileAppender
rootLogger.appenderRef.errorFile.ref = ErrorFileAppender

# Package-specific logging levels
# Application packages - set to DEBUG for development, INFO for production
logger.messegeserver.name = org.messegeserver
logger.messegeserver.level = TRACE
logger.messegeserver.additivity = false
logger.messegeserver.appenderRefs = console, file, errorFile
logger.messegeserver.appenderRef.console.ref = ConsoleAppender
logger.messegeserver.appenderRef.file.ref = FileAppender
logger.messegeserver.appenderRef.errorFile.ref = ErrorFileAppender

# Netty logging - set to INFO to reduce noise
logger.netty.name = io.netty
logger.netty.level = TRACE

# Kodein DI logging
logger.kodein.name = org.kodein.di
logger.kodein.level = INFO

# Security: Disable JNDI lookups to prevent Log4Shell vulnerability
# This is already fixed in 2.23.1, but keeping it explicit for safety
log4j2.formatMsgNoLookups = true
